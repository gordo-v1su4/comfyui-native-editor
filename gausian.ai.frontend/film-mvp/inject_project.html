
<!DOCTYPE html>
<html>
<head>
    <title>OpenCut Project Injector</title>
</head>
<body>
    <h1>Injecting Project: The Green Knight's Vigil</h1>
    <div id="status">Initializing...</div>
    
    <script>
        const projectData = {"id": "FZPXrmURdsf0LVHlHZntI", "name": "The Green Knight's Vigil", "thumbnail": "", "createdAt": "2025-08-13T09:30:55.509Z", "updatedAt": "2025-08-13T09:30:55.509Z", "backgroundColor": "#000000", "backgroundType": "color", "blurIntensity": 8, "bookmarks": [], "fps": 24, "canvasSize": {"width": 720, "height": 480}, "canvasMode": "preset"};
        
        async function injectProject() {
            try {
                // Open IndexedDB
                const dbName = 'video-editor-projects';
                const request = indexedDB.open(dbName, 1);
                
                request.onerror = () => {
                    document.getElementById('status').innerHTML = '❌ Failed to open IndexedDB';
                };
                
                request.onsuccess = (event) => {
                    const db = event.target.result;
                    const transaction = db.transaction(['projects'], 'readwrite');
                    const store = transaction.objectStore('projects');
                    
                    // Convert project data to OpenCut format
                    const opencutProject = {
                        id: projectData.id,
                        name: projectData.name,
                        thumbnail: projectData.thumbnail,
                        createdAt: projectData.createdAt,
                        updatedAt: projectData.updatedAt,
                        backgroundColor: projectData.backgroundColor,
                        backgroundType: projectData.backgroundType,
                        blurIntensity: projectData.blurIntensity,
                        bookmarks: projectData.bookmarks,
                        fps: projectData.fps,
                        canvasSize: projectData.canvasSize,
                        canvasMode: projectData.canvasMode
                    };
                    
                    // Store the project
                    const addRequest = store.put(opencutProject);
                    
                    addRequest.onsuccess = () => {
                        document.getElementById('status').innerHTML = '✅ Project injected successfully!';
                        document.getElementById('status').style.color = 'green';
                        
                        // Redirect to OpenCut after a short delay
                        setTimeout(() => {
                            window.location.href = 'http://localhost:3000/projects';
                        }, 2000);
                    };
                    
                    addRequest.onerror = () => {
                        document.getElementById('status').innerHTML = '❌ Failed to store project';
                        document.getElementById('status').style.color = 'red';
                    };
                };
                
                request.onupgradeneeded = (event) => {
                    const db = event.target.result;
                    if (!db.objectStoreNames.contains('projects')) {
                        db.createObjectStore('projects', { keyPath: 'id' });
                    }
                };
                
            } catch (error) {
                document.getElementById('status').innerHTML = '❌ Error: ' + error.message;
                document.getElementById('status').style.color = 'red';
            }
        }
        
        // Run injection when page loads
        window.onload = injectProject;
    </script>
</body>
</html>
